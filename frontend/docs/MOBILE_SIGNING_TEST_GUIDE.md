# ç§»åŠ¨ç«¯äº¤æ˜“ç­¾å - å®Œæ•´æµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡

åœ¨ç§»åŠ¨ç«¯ï¼ˆReact Nativeï¼‰ç¯å¢ƒä¸‹å®Œæˆå®Œæ•´çš„äº¤æ˜“ç­¾åæµç¨‹ï¼ŒåŒ…æ‹¬ï¼š
1. åˆå§‹åŒ–ç­¾åå™¨
2. è§£é”é’±åŒ…
3. åˆ›å»ºè®¢å•
4. ç­¾åäº¤æ˜“
5. éªŒè¯ä¸Šé“¾

---

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. ç¡®ä¿åŒºå—é“¾èŠ‚ç‚¹è¿è¡Œ

```bash
cd ../node
./target/release/stardust-node --dev --tmp
```

### 2. ç¡®ä¿æœ‰æµ‹è¯•é’±åŒ…

å¦‚æœè¿˜æ²¡æœ‰é’±åŒ…ï¼Œéœ€è¦å…ˆåˆ›å»ºï¼š

```bash
cd frontend
npm start
```

åœ¨åº”ç”¨ä¸­ï¼š
1. æ‰“å¼€é’±åŒ…é¡µé¢
2. åˆ›å»ºæ–°é’±åŒ…
3. è®°ä½å¯†ç ï¼ˆæµ‹è¯•ç”¨ï¼‰
4. ä¿å­˜åŠ©è®°è¯

### 3. ç¡®ä¿è´¦æˆ·æœ‰ä½™é¢

å¼€å‘é“¾çš„ Alice è´¦æˆ·é»˜è®¤æœ‰ä½™é¢ï¼Œå¯ä»¥è½¬è´¦ç»™æµ‹è¯•è´¦æˆ·ï¼š

```bash
# ä½¿ç”¨ polkadot.js è½¬è´¦
# æˆ–åœ¨åº”ç”¨ä¸­ä» Alice è½¬è´¦åˆ°æµ‹è¯•è´¦æˆ·
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: å¯åŠ¨åº”ç”¨

```bash
cd frontend
npm start
```

é€‰æ‹©ç§»åŠ¨ç«¯æ¨¡æ‹Ÿå™¨ï¼ˆiOS æˆ– Androidï¼‰

---

### æ­¥éª¤ 2: åˆå§‹åŒ– API

åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆå§‹åŒ– APIï¼Œè§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—ï¼š

```
[API] Initializing Polkadot API...
[API] Provider URL: ws://localhost:9944
[API] Connected to chain: Development
[API] Node version: x.x.x
```

**éªŒè¯ç‚¹**:
- âœ… API è¿æ¥æˆåŠŸ
- âœ… æ— é”™è¯¯æ—¥å¿—

---

### æ­¥éª¤ 3: å¯¼èˆªåˆ°è´­ä¹°é¡µé¢

1. æ‰“å¼€åº”ç”¨
2. å¯¼èˆªåˆ° "é’±åŒ…" æ ‡ç­¾
3. ç‚¹å‡» "è´­ä¹° DUST"
4. æˆ–ç›´æ¥è®¿é—® `/wallet/buy-dust`

**éªŒè¯ç‚¹**:
- âœ… é¡µé¢åŠ è½½æˆåŠŸ
- âœ… æ˜¾ç¤ºåšå¸‚å•†åˆ—è¡¨
- âœ… æ˜¾ç¤ºå½“å‰ä»·æ ¼

---

### æ­¥éª¤ 4: é€‰æ‹©åšå¸‚å•†

1. æŸ¥çœ‹åšå¸‚å•†åˆ—è¡¨
2. é€‰æ‹©ä¸€ä¸ªåšå¸‚å•†ï¼ˆç‚¹å‡»å¡ç‰‡ï¼‰
3. ç‚¹å‡» "ç«‹å³é¦–è´­" æˆ– "åˆ›å»ºé¦–è´­è®¢å•"

**éªŒè¯ç‚¹**:
- âœ… åšå¸‚å•†å¡ç‰‡é«˜äº®
- âœ… æŒ‰é’®å¯ç‚¹å‡»

---

### æ­¥éª¤ 5: å¡«å†™æ”¯ä»˜ä¿¡æ¯

æ”¯ä»˜ä¿¡æ¯è¡¨å•ä¼šå¼¹å‡ºï¼Œå¡«å†™æµ‹è¯•æ•°æ®ï¼š

```
çœŸå®å§“å: å¼ ä¸‰
èº«ä»½è¯å·: 110101199001011234
æ‰‹æœºå·: 13812345678
å¾®ä¿¡å·: wechat_test123
```

ç‚¹å‡» "ç¡®è®¤"

**éªŒè¯ç‚¹**:
- âœ… è¡¨å•éªŒè¯é€šè¿‡
- âœ… è¡¨å•å…³é—­

---

### æ­¥éª¤ 6: è§£é”é’±åŒ…ï¼ˆå…³é”®æ­¥éª¤ï¼‰

æ­¤æ—¶ä¼šå¼¹å‡º "è§£é”é’±åŒ…" å¯¹è¯æ¡†ï¼š

1. è¾“å…¥é’±åŒ…å¯†ç 
2. ç‚¹å‡» "è§£é”"

**è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—**:
```
[MobileSigner] Unlocking wallet...
[MobileSigner] Wallet unlocked: 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
```

**éªŒè¯ç‚¹**:
- âœ… å¯†ç è¾“å…¥æ¡†æ˜¾ç¤º
- âœ… æ­£ç¡®å¯†ç è§£é”æˆåŠŸ
- âœ… é”™è¯¯å¯†ç æ˜¾ç¤ºé”™è¯¯æç¤º
- âœ… å¯¹è¯æ¡†å…³é—­

---

### æ­¥éª¤ 7: ç­¾åäº¤æ˜“ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰

è§£é”æˆåŠŸåï¼Œä¼šè‡ªåŠ¨å¼€å§‹åˆ›å»ºè®¢å•ï¼š

1. æ˜¾ç¤º "äº¤æ˜“å¤„ç†ä¸­" å¯¹è¯æ¡†
2. çŠ¶æ€ä¾æ¬¡å˜åŒ–ï¼š
   - "å‡†å¤‡ä¸­..."
   - "å¹¿æ’­ä¸­..."
   - "å·²æ‰“åŒ…..."
   - "å·²ç¡®è®¤"

**è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—**:
```
[Trading] Creating first purchase order...
[UnifiedSigner] Signing transaction...
[MobileSigner] Transaction in block: 0x1234...
[Trading] First purchase created, order ID: 1
```

**éªŒè¯ç‚¹**:
- âœ… çŠ¶æ€å¯¹è¯æ¡†æ˜¾ç¤º
- âœ… çŠ¶æ€æ–‡æœ¬æ›´æ–°
- âœ… æ— é”™è¯¯æç¤º

---

### æ­¥éª¤ 8: éªŒè¯äº¤æ˜“æˆåŠŸ

äº¤æ˜“æˆåŠŸåï¼š

1. å¯¹è¯æ¡†å…³é—­
2. æ˜¾ç¤ºæˆåŠŸæç¤º
3. è‡ªåŠ¨è·³è½¬åˆ°è®¢å•è¯¦æƒ…é¡µ

**éªŒè¯ç‚¹**:
- âœ… æ˜¾ç¤º "é¦–è´­è®¢å•åˆ›å»ºæˆåŠŸ"
- âœ… è·å¾—è®¢å• ID
- âœ… è·³è½¬åˆ°è®¢å•è¯¦æƒ…é¡µ
- âœ… è®¢å•ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º

---

### æ­¥éª¤ 9: æŸ¥çœ‹è®¢å•è¯¦æƒ…

åœ¨è®¢å•è¯¦æƒ…é¡µé¢ï¼š

1. æŸ¥çœ‹è®¢å•ä¿¡æ¯
2. æŸ¥çœ‹å€’è®¡æ—¶
3. æŸ¥çœ‹æ”¶æ¬¾åœ°å€

**éªŒè¯ç‚¹**:
- âœ… è®¢å•å·æ­£ç¡®
- âœ… é‡‘é¢æ­£ç¡®ï¼ˆ10 USDï¼‰
- âœ… DUST æ•°é‡æ­£ç¡®
- âœ… å€’è®¡æ—¶è¿è¡Œ
- âœ… æ”¶æ¬¾åœ°å€æ˜¾ç¤º

---

### æ­¥éª¤ 10: éªŒè¯é“¾ä¸Šæ•°æ®

ä½¿ç”¨ Polkadot.js Apps éªŒè¯ï¼š

1. æ‰“å¼€ https://polkadot.js.org/apps/
2. è¿æ¥åˆ°æœ¬åœ°èŠ‚ç‚¹ (ws://localhost:9944)
3. å¯¼èˆªåˆ° Developer > Chain state
4. æŸ¥è¯¢ otcOrder.orders(1)

**éªŒè¯ç‚¹**:
- âœ… è®¢å•å­˜åœ¨
- âœ… è®¢å•çŠ¶æ€ä¸º "Created"
- âœ… è®¢å•ä¿¡æ¯æ­£ç¡®

---

## ğŸ” è¯¦ç»†æ—¥å¿—åˆ†æ

### å®Œæ•´çš„æˆåŠŸæ—¥å¿—ç¤ºä¾‹

```
# 1. API åˆå§‹åŒ–
[API] Initializing Polkadot API...
[API] Connected to chain: Development

# 2. è·å–åšå¸‚å•†
[Trading] Fetching makers...
[Trading] Found 2 makers

# 3. ç”¨æˆ·æ“ä½œ
[Trading] Maker selected: 1
[Trading] Creating first purchase order...

# 4. æ£€æŸ¥é’±åŒ…çŠ¶æ€
[UnifiedSigner] Checking wallet status...
[UnifiedSigner] Wallet is locked, showing unlock dialog

# 5. è§£é”é’±åŒ…
[MobileSigner] Unlocking wallet...
[MobileSigner] Wallet unlocked: 5GrwvaEF...

# 6. åˆ›å»ºäº¤æ˜“
[Trading] Creating transaction...
[Trading] Payment commit: 0x1234...
[Trading] Contact commit: 0x5678...

# 7. ç­¾åäº¤æ˜“
[UnifiedSigner] Signing transaction...
[MobileSigner] Status: å‡†å¤‡ä¸­...
[MobileSigner] Status: å¹¿æ’­ä¸­...
[MobileSigner] Status: å·²æ‰“åŒ…...
[MobileSigner] Transaction in block: 0xabcd...

# 8. è§£æäº‹ä»¶
[Trading] Parsing events...
[Trading] FirstPurchaseCreated event found
[Trading] Order ID: 1

# 9. å®Œæˆ
[Trading] First purchase created successfully
```

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: è§£é”å¯¹è¯æ¡†ä¸æ˜¾ç¤º

**ç—‡çŠ¶**: ç‚¹å‡»åˆ›å»ºè®¢å•åæ²¡æœ‰å¼¹å‡ºè§£é”å¯¹è¯æ¡†

**å¯èƒ½åŸå› **:
1. ç¯å¢ƒæ£€æµ‹é”™è¯¯
2. é’±åŒ…å·²è§£é”

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// æ£€æŸ¥ç¯å¢ƒ
console.log('Is web:', isWebEnvironment());
console.log('Is unlocked:', isSignerUnlocked());
```

---

### é—®é¢˜ 2: å¯†ç é”™è¯¯

**ç—‡çŠ¶**: è¾“å…¥å¯†ç åæç¤º "å¯†ç é”™è¯¯"

**å¯èƒ½åŸå› **:
1. å¯†ç è¾“å…¥é”™è¯¯
2. åŠ©è®°è¯ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤å¯†ç æ­£ç¡®
2. æ£€æŸ¥å½“å‰è´¦æˆ·åœ°å€
3. å°è¯•é‡æ–°å¯¼å…¥é’±åŒ…

---

### é—®é¢˜ 3: äº¤æ˜“å¤±è´¥

**ç—‡çŠ¶**: æ˜¾ç¤º "åˆ›å»ºè®¢å•å¤±è´¥"

**å¯èƒ½åŸå› **:
1. ä½™é¢ä¸è¶³
2. å·²å®Œæˆé¦–è´­
3. åšå¸‚å•†ä¸å¯ç”¨
4. ç½‘ç»œè¿æ¥é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// æŸ¥çœ‹è¯¦ç»†é”™è¯¯
catch (error) {
  console.error('Error details:', error);
  // æ£€æŸ¥é”™è¯¯ç±»å‹
  if (error.message.includes('InsufficientBalance')) {
    // ä½™é¢ä¸è¶³
  } else if (error.message.includes('FirstPurchaseAlreadyCompleted')) {
    // å·²å®Œæˆé¦–è´­
  }
}
```

---

### é—®é¢˜ 4: çŠ¶æ€ä¸æ›´æ–°

**ç—‡çŠ¶**: äº¤æ˜“çŠ¶æ€ä¸€ç›´æ˜¾ç¤º "å‡†å¤‡ä¸­..."

**å¯èƒ½åŸå› **:
1. çŠ¶æ€å›è°ƒæœªè§¦å‘
2. äº¤æ˜“å¡ä½

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// æ·»åŠ è¶…æ—¶å¤„ç†
const timeout = setTimeout(() => {
  console.error('Transaction timeout');
  setShowTxStatus(false);
}, 60000); // 60 ç§’è¶…æ—¶
```

---

### é—®é¢˜ 5: é’±åŒ…è‡ªåŠ¨é”å®š

**ç—‡çŠ¶**: è§£é”åç«‹å³åˆé”å®š

**å¯èƒ½åŸå› **:
1. è§£é”å¤±è´¥
2. å¯†é’¥å¯¹æœªä¿å­˜

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// æ£€æŸ¥è§£é”çŠ¶æ€
const unlocked = await unlockWallet(password);
console.log('Unlock result:', unlocked);
console.log('Is unlocked:', isWalletUnlocked());
```

---

## ğŸ“Š æµ‹è¯•æ£€æŸ¥æ¸…å•

### åŸºç¡€åŠŸèƒ½
- [ ] API åˆå§‹åŒ–æˆåŠŸ
- [ ] åšå¸‚å•†åˆ—è¡¨åŠ è½½
- [ ] é¡µé¢å¯¼èˆªæ­£å¸¸

### è§£é”æµç¨‹
- [ ] è§£é”å¯¹è¯æ¡†æ˜¾ç¤º
- [ ] å¯†ç è¾“å…¥æ­£å¸¸
- [ ] æ­£ç¡®å¯†ç è§£é”æˆåŠŸ
- [ ] é”™è¯¯å¯†ç æç¤ºé”™è¯¯
- [ ] å–æ¶ˆæŒ‰é’®å·¥ä½œ

### äº¤æ˜“æµç¨‹
- [ ] äº¤æ˜“åˆ›å»ºæˆåŠŸ
- [ ] çŠ¶æ€å¯¹è¯æ¡†æ˜¾ç¤º
- [ ] çŠ¶æ€æ–‡æœ¬æ›´æ–°
- [ ] äº¤æ˜“ç­¾åæˆåŠŸ
- [ ] äº¤æ˜“ä¸Šé“¾æˆåŠŸ

### è®¢å•éªŒè¯
- [ ] è·å¾—è®¢å• ID
- [ ] è·³è½¬åˆ°è¯¦æƒ…é¡µ
- [ ] è®¢å•ä¿¡æ¯æ­£ç¡®
- [ ] é“¾ä¸Šæ•°æ®æ­£ç¡®

### é”™è¯¯å¤„ç†
- [ ] ä½™é¢ä¸è¶³æç¤º
- [ ] ç½‘ç»œé”™è¯¯æç¤º
- [ ] äº¤æ˜“å¤±è´¥æç¤º
- [ ] è¶…æ—¶å¤„ç†

---

## ğŸ¬ å½•å±å»ºè®®

å»ºè®®å½•åˆ¶ä»¥ä¸‹åœºæ™¯ï¼š

1. **å®Œæ•´é¦–è´­æµç¨‹** (2-3 åˆ†é’Ÿ)
   - ä»é€‰æ‹©åšå¸‚å•†åˆ°è®¢å•åˆ›å»ºæˆåŠŸ
   - åŒ…å«è§£é”é’±åŒ…æ­¥éª¤
   - æ˜¾ç¤ºæ‰€æœ‰çŠ¶æ€å˜åŒ–

2. **é”™è¯¯å¤„ç†** (1-2 åˆ†é’Ÿ)
   - é”™è¯¯å¯†ç 
   - å–æ¶ˆè§£é”
   - äº¤æ˜“å¤±è´¥

3. **çŠ¶æ€æ›´æ–°** (1 åˆ†é’Ÿ)
   - äº¤æ˜“çŠ¶æ€å®æ—¶æ›´æ–°
   - ä»å‡†å¤‡åˆ°ç¡®è®¤çš„å®Œæ•´è¿‡ç¨‹

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```markdown
# ç§»åŠ¨ç«¯ç­¾åæµ‹è¯•æŠ¥å‘Š

**æµ‹è¯•æ—¥æœŸ**: 2026-01-10
**æµ‹è¯•äººå‘˜**: [å§“å]
**æµ‹è¯•ç¯å¢ƒ**:
- è®¾å¤‡: iPhone 14 Pro / Android Pixel 6
- ç³»ç»Ÿç‰ˆæœ¬: iOS 17.0 / Android 13
- åº”ç”¨ç‰ˆæœ¬: 1.0.0
- èŠ‚ç‚¹ç‰ˆæœ¬: x.x.x

## æµ‹è¯•ç»“æœ

### é€šè¿‡çš„æµ‹è¯•
- [x] è§£é”é’±åŒ…
- [x] åˆ›å»ºé¦–è´­è®¢å•
- [x] äº¤æ˜“ç­¾å
- [x] äº¤æ˜“ä¸Šé“¾
- [x] çŠ¶æ€æ›´æ–°

### å¤±è´¥çš„æµ‹è¯•
- [ ] æ— 

### å‘ç°çš„é—®é¢˜
1. æ— 

### æ€§èƒ½æŒ‡æ ‡
- è§£é”æ—¶é—´: 0.5 ç§’
- ç­¾åæ—¶é—´: 1.2 ç§’
- ä¸Šé“¾æ—¶é—´: 6.5 ç§’
- æ€»è€—æ—¶: 8.2 ç§’

### ç”¨æˆ·ä½“éªŒè¯„åˆ†
- æµç•…åº¦: â­â­â­â­â­
- å“åº”é€Ÿåº¦: â­â­â­â­â­
- é”™è¯¯æç¤º: â­â­â­â­â­
- æ•´ä½“ä½“éªŒ: â­â­â­â­â­

## å»ºè®®
- æ— 

## æˆªå›¾
[é™„ä¸Šå…³é”®æ­¥éª¤çš„æˆªå›¾]
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

æµ‹è¯•é€šè¿‡åï¼š

1. âœ… æ›´æ–°å…¶ä»–é¡µé¢ä½¿ç”¨ç§»åŠ¨ç«¯ç­¾å
2. âœ… æ·»åŠ ç”Ÿç‰©è¯†åˆ«æ”¯æŒ
3. âœ… å®ç°è‡ªåŠ¨é”å®šæœºåˆ¶
4. âœ… ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ
5. âœ… å‡†å¤‡ä¸Šçº¿

---

## ğŸ’¡ è°ƒè¯•æŠ€å·§

### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—

åœ¨ `signer.native.ts` ä¸­æ·»åŠ ï¼š

```typescript
console.log('[Debug] Keyring:', this.keyring);
console.log('[Debug] Current pair:', this.currentPair);
console.log('[Debug] Is unlocked:', this.isUnlocked());
```

### 2. æ¨¡æ‹Ÿäº¤æ˜“çŠ¶æ€

```typescript
// æµ‹è¯•çŠ¶æ€æ›´æ–°
const statuses = ['å‡†å¤‡ä¸­...', 'å¹¿æ’­ä¸­...', 'å·²æ‰“åŒ…...', 'å·²ç¡®è®¤'];
let i = 0;
const interval = setInterval(() => {
  setTxStatus(statuses[i]);
  i++;
  if (i >= statuses.length) clearInterval(interval);
}, 1000);
```

### 3. æ£€æŸ¥å¯†é’¥å¯¹

```typescript
const pair = getCurrentPair();
console.log('Address:', pair?.address);
console.log('Public key:', pair?.publicKey);
```

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹æµ‹è¯•ï¼** ğŸ‰
