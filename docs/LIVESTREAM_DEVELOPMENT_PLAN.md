# ç›´æ’­é—´æ¨¡å—å¼€å‘è®¡åˆ’

åŸºäº `LIVESTREAM_MODULE_DESIGN.md` å’Œ `LIVESTREAM_DESIGN_EVALUATION.md` åˆ¶å®šçš„åˆ†é˜¶æ®µå¼€å‘è®¡åˆ’ã€‚

---

## å¼€å‘é˜¶æ®µæ¦‚è§ˆ

| é˜¶æ®µ | åç§° | å‘¨æœŸ | ç›®æ ‡ |
|------|------|------|------|
| Phase 1 | é“¾ä¸ŠåŸºç¡€æ¨¡å— | 2 å‘¨ | pallet-livestream æ ¸å¿ƒåŠŸèƒ½ |
| Phase 2 | åç«¯æœåŠ¡ | 1.5 å‘¨ | Token ç”Ÿæˆã€ç­¾åéªŒè¯ã€LiveKit é›†æˆ |
| Phase 3 | å‰ç«¯æ’­æ”¾å™¨ | 2 å‘¨ | ä¸»æ’­æ¨æµã€è§‚ä¼—è§‚çœ‹ |
| Phase 4 | äº’åŠ¨åŠŸèƒ½ | 1.5 å‘¨ | èŠå¤©ã€å¼¹å¹•ã€ç¤¼ç‰© |
| Phase 5 | é«˜çº§åŠŸèƒ½ | 2 å‘¨ | è¿éº¦ã€ä»˜è´¹ç›´æ’­ |
| Phase 6 | æµ‹è¯•ä¼˜åŒ– | 1 å‘¨ | é›†æˆæµ‹è¯•ã€æ€§èƒ½ä¼˜åŒ– |

**æ€»è®¡: 10 å‘¨**

---

## Phase 1: é“¾ä¸ŠåŸºç¡€æ¨¡å— (2 å‘¨)

### 1.1 åˆ›å»º Pallet ç»“æ„ (Day 1-2)

```
pallets/livestream/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ README.md
â””â”€â”€ src/
    â”œâ”€â”€ lib.rs           # ä¸»æ¨¡å—å…¥å£
    â”œâ”€â”€ types.rs         # ç±»å‹å®šä¹‰
    â”œâ”€â”€ weights.rs       # æƒé‡å®šä¹‰
    â”œâ”€â”€ mock.rs          # æµ‹è¯• mock
    â””â”€â”€ tests.rs         # å•å…ƒæµ‹è¯•
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `Cargo.toml`ï¼Œæ·»åŠ ä¾èµ–
- [ ] å®šä¹‰ `Config` trait
- [ ] å®šä¹‰å¸¸é‡å‚æ•° (MaxTitleLen, MaxCoHostsPerRoom ç­‰)

### 1.2 ç±»å‹å®šä¹‰ (Day 2-3)

**æ–‡ä»¶**: `src/types.rs`

```rust
// éœ€è¦å®ç°çš„ç±»å‹
pub enum LiveRoomStatus { Preparing, Live, Paused, Ended, Banned }
pub enum LiveRoomType { Normal, Paid, Private, MultiHost }
pub enum CoHostType { AudioOnly, VideoAndAudio }

pub struct LiveRoom<...> { ... }
pub struct Gift<Balance> { ... }
pub struct Ticket<AccountId> { ... }
```

**ä»»åŠ¡æ¸…å•**:
- [ ] `LiveRoomStatus` æšä¸¾
- [ ] `LiveRoomType` æšä¸¾
- [ ] `LiveRoom` ç»“æ„ä½“
- [ ] `Gift` ç»“æ„ä½“
- [ ] `Ticket` ç»“æ„ä½“
- [ ] `CoHostType` æšä¸¾

### 1.3 å­˜å‚¨å®šä¹‰ (Day 3-4)

**æ–‡ä»¶**: `src/lib.rs`

```rust
// éœ€è¦å®ç°çš„å­˜å‚¨
LiveRooms<T>           // ç›´æ’­é—´ä¿¡æ¯
HostRoom<T>            // ä¸»æ’­ -> ç›´æ’­é—´æ˜ å°„
NextRoomId<T>          // è‡ªå¢ ID
Gifts<T>               // ç¤¼ç‰©å®šä¹‰
UserRoomGifts<T>       // ç”¨æˆ·æ‰“èµè®°å½•
HostEarnings<T>        // ä¸»æ’­æ”¶ç›Š
TicketHolders<T>       // é—¨ç¥¨æŒæœ‰è€…
RoomBlacklist<T>       // é»‘åå•
ActiveCoHosts<T>       // è¿éº¦è€…åˆ—è¡¨
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®šä¹‰æ‰€æœ‰ StorageMap/StorageDoubleMap
- [ ] è®¾ç½®é»˜è®¤å€¼å’Œ ValueQuery

### 1.4 äº‹ä»¶å®šä¹‰ (Day 4)

```rust
// éœ€è¦å®ç°çš„äº‹ä»¶
RoomCreated, LiveStarted, LivePaused, LiveResumed, LiveEnded
TicketPurchased, GiftSent, EarningsWithdrawn
ViewerKicked, ViewerUnbanned, RoomBanned
CoHostStarted, CoHostEnded
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®šä¹‰æ‰€æœ‰äº‹ä»¶åŠå…¶å‚æ•°
- [ ] ç¡®ä¿äº‹ä»¶åŒ…å«è¶³å¤Ÿä¿¡æ¯ä¾›ç´¢å¼•å™¨ä½¿ç”¨

### 1.5 é”™è¯¯å®šä¹‰ (Day 4-5)

```rust
// éœ€è¦å®ç°çš„é”™è¯¯
RoomNotFound, NotRoomHost, RoomNotLive, RoomAlreadyLive
GiftNotFound, GiftDisabled, InsufficientBalance
AlreadyHasTicket, TicketRequired
AlreadyInBlacklist, NotInBlacklist
TooManyCoHosts, AlreadyCoHost, NotCoHost
Overflow, NotAuthorized
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®šä¹‰æ‰€æœ‰é”™è¯¯ç±»å‹
- [ ] æ·»åŠ é”™è¯¯æè¿°æ–‡æ¡£

### 1.6 ç›´æ’­é—´ç®¡ç†å‡½æ•° (Day 5-7)

```rust
// éœ€è¦å®ç°çš„ extrinsics
create_room(title, description, room_type, cover_cid, ticket_price)
start_live(room_id)
pause_live(room_id)
resume_live(room_id)
end_live(room_id)
update_room(room_id, title, description, cover_cid)
```

**ä»»åŠ¡æ¸…å•**:
- [ ] `create_room` - åˆ›å»ºç›´æ’­é—´ï¼Œç”Ÿæˆè‡ªå¢ ID
- [ ] `start_live` - å¼€å§‹ç›´æ’­ï¼Œæ›´æ–°çŠ¶æ€
- [ ] `pause_live` - æš‚åœç›´æ’­
- [ ] `resume_live` - æ¢å¤ç›´æ’­
- [ ] `end_live` - ç»“æŸç›´æ’­ï¼Œè®°å½•ç»Ÿè®¡
- [ ] `update_room` - æ›´æ–°ç›´æ’­é—´ä¿¡æ¯

### 1.7 ç¤¼ç‰©ç³»ç»Ÿå‡½æ•° (Day 7-9)

```rust
// éœ€è¦å®ç°çš„ extrinsics
send_gift(room_id, gift_id, quantity)
withdraw_earnings(amount)
sync_live_stats(room_id, total_viewers, peak_viewers)
```

**ä»»åŠ¡æ¸…å•**:
- [ ] `send_gift` - å‘é€ç¤¼ç‰©ï¼Œå«åˆ†æˆé€»è¾‘
- [ ] `withdraw_earnings` - ä¸»æ’­æç°
- [ ] `sync_live_stats` - åŒæ­¥ç›´æ’­ç»Ÿè®¡ (åç«¯è°ƒç”¨)
- [ ] å®ç°å¹³å°æŠ½æˆè®¡ç®— (80% ä¸»æ’­ / 20% å¹³å°)

### 1.8 ç®¡ç†åŠŸèƒ½å‡½æ•° (Day 9-10)

```rust
// éœ€è¦å®ç°çš„ extrinsics
buy_ticket(room_id)
kick_viewer(room_id, viewer)
remove_from_blacklist(room_id, viewer)
ban_room(room_id, reason)  // ç®¡ç†å‘˜
```

**ä»»åŠ¡æ¸…å•**:
- [ ] `buy_ticket` - è´­ä¹°ä»˜è´¹ç›´æ’­é—¨ç¥¨
- [ ] `kick_viewer` - è¸¢å‡ºè§‚ä¼—å¹¶åŠ å…¥é»‘åå•
- [ ] `remove_from_blacklist` - ä»é»‘åå•ç§»é™¤
- [ ] `ban_room` - å°ç¦ç›´æ’­é—´ (GovernanceOrigin)

### 1.9 è¿éº¦åŠŸèƒ½å‡½æ•° (Day 10-11)

```rust
// éœ€è¦å®ç°çš„ extrinsics
start_co_host(room_id, co_host)
end_co_host(room_id, co_host)
```

**ä»»åŠ¡æ¸…å•**:
- [ ] `start_co_host` - è®°å½•è¿éº¦å¼€å§‹
- [ ] `end_co_host` - è®°å½•è¿éº¦ç»“æŸ

### 1.10 å•å…ƒæµ‹è¯• (Day 11-14)

**æ–‡ä»¶**: `src/tests.rs`, `src/mock.rs`

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºæµ‹è¯• mock runtime
- [ ] æµ‹è¯•ç›´æ’­é—´åˆ›å»º/å¼€æ’­/ç»“æŸæµç¨‹
- [ ] æµ‹è¯•ç¤¼ç‰©å‘é€å’Œåˆ†æˆè®¡ç®—
- [ ] æµ‹è¯•é—¨ç¥¨è´­ä¹°
- [ ] æµ‹è¯•é»‘åå•åŠŸèƒ½
- [ ] æµ‹è¯•è¿éº¦åŠŸèƒ½
- [ ] æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†

### 1.11 Runtime é›†æˆ (Day 14)

**ä»»åŠ¡æ¸…å•**:
- [ ] åœ¨ `runtime/Cargo.toml` æ·»åŠ ä¾èµ–
- [ ] åœ¨ `runtime/src/lib.rs` é…ç½® pallet
- [ ] æ·»åŠ åˆ° `construct_runtime!`
- [ ] ç¼–è¯‘æµ‹è¯•

---

## Phase 2: åç«¯æœåŠ¡ (1.5 å‘¨)

### 2.1 é¡¹ç›®ç»“æ„ (Day 1)

```
backend/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # å…¥å£
â”‚   â”œâ”€â”€ config.ts             # é…ç½®
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ livestream.ts     # ç›´æ’­ç›¸å…³è·¯ç”±
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ livekit.ts        # LiveKit æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ substrate.ts      # Substrate è¿æ¥
â”‚   â”‚   â””â”€â”€ signature.ts      # ç­¾åéªŒè¯
â”‚   â””â”€â”€ middleware/
â”‚       â””â”€â”€ auth.ts           # è®¤è¯ä¸­é—´ä»¶
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆå§‹åŒ– Node.js é¡¹ç›®
- [ ] å®‰è£…ä¾èµ–: express, livekit-server-sdk, @polkadot/api
- [ ] é…ç½® TypeScript

### 2.2 Substrate è¿æ¥æœåŠ¡ (Day 1-2)

**æ–‡ä»¶**: `src/services/substrate.ts`

```typescript
// éœ€è¦å®ç°
- è¿æ¥ Substrate èŠ‚ç‚¹
- æŸ¥è¯¢ç›´æ’­é—´ä¿¡æ¯
- æŸ¥è¯¢é—¨ç¥¨æŒæœ‰è€…
- æŸ¥è¯¢é»‘åå•
- ç›‘å¬é“¾ä¸Šäº‹ä»¶
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° `SubstrateService` ç±»
- [ ] è¿æ¥æ± ç®¡ç†
- [ ] æ–­çº¿é‡è¿æœºåˆ¶
- [ ] æŸ¥è¯¢æ–¹æ³•å°è£…

### 2.3 ç­¾åéªŒè¯æœåŠ¡ (Day 2-3)

**æ–‡ä»¶**: `src/services/signature.ts`

```typescript
// éœ€è¦å®ç°
- éªŒè¯ä¸»æ’­ç­¾å
- æ£€æŸ¥æ—¶é—´æˆ³æœ‰æ•ˆæ€§ (5åˆ†é’Ÿçª—å£)
- æŸ¥è¯¢é“¾ä¸Šç¡®è®¤æˆ¿ä¸»èº«ä»½
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° `verifyHostSignature(roomId, publicKey, signature, timestamp)`
- [ ] é˜²é‡æ”¾æ”»å‡»æ£€æŸ¥
- [ ] é”™è¯¯å¤„ç†

### 2.4 LiveKit Token æœåŠ¡ (Day 3-4)

**æ–‡ä»¶**: `src/services/livekit.ts`

```typescript
// éœ€è¦å®ç°
- ç”Ÿæˆä¸»æ’­æ¨æµ Token (canPublish: true)
- ç”Ÿæˆè§‚ä¼—è§‚çœ‹ Token (canPublish: false)
- ç”Ÿæˆè¿éº¦è€… Token (canPublish: true)
- Token æƒé™é…ç½®
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° `generatePublisherToken(roomId, hostAddress)`
- [ ] å®ç° `generateViewerToken(roomId, viewerAddress)`
- [ ] å®ç° `generateCoHostToken(roomId, coHostAddress)`
- [ ] é…ç½® Token TTL å’Œæƒé™

### 2.5 API è·¯ç”± (Day 4-6)

**æ–‡ä»¶**: `src/routes/livestream.ts`

```typescript
// éœ€è¦å®ç°çš„ API
POST /api/livestream/publisher-token   // ä¸»æ’­è·å–æ¨æµ Token
POST /api/livestream/viewer-token      // è§‚ä¼—è·å–è§‚çœ‹ Token
POST /api/livestream/co-host-token     // è¿éº¦è€…è·å– Token
GET  /api/livestream/room/:roomId      // è·å–ç›´æ’­é—´ä¿¡æ¯
GET  /api/livestream/rooms             // è·å–ç›´æ’­é—´åˆ—è¡¨
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç°ä¸»æ’­ Token æ¥å£ (å«ç­¾åéªŒè¯)
- [ ] å®ç°è§‚ä¼— Token æ¥å£ (å«é—¨ç¥¨/é»‘åå•æ£€æŸ¥)
- [ ] å®ç°è¿éº¦è€… Token æ¥å£
- [ ] å®ç°ç›´æ’­é—´æŸ¥è¯¢æ¥å£

### 2.6 LiveKit Webhook (Day 6-7)

```typescript
// éœ€è¦å¤„ç†çš„ Webhook äº‹ä»¶
- participant_joined   // è§‚ä¼—è¿›å…¥
- participant_left     // è§‚ä¼—ç¦»å¼€
- room_started         // ç›´æ’­å¼€å§‹
- room_finished        // ç›´æ’­ç»“æŸ
```

**ä»»åŠ¡æ¸…å•**:
- [ ] é…ç½® Webhook æ¥æ”¶ç«¯ç‚¹
- [ ] å¤„ç†è§‚ä¼—è¿›å‡ºäº‹ä»¶ (æ›´æ–°è®¡æ•°)
- [ ] å¤„ç†ç›´æ’­ç»“æŸäº‹ä»¶ (åŒæ­¥ç»Ÿè®¡åˆ°é“¾ä¸Š)
- [ ] Webhook ç­¾åéªŒè¯

### 2.7 é”™è¯¯å¤„ç†å’Œæ—¥å¿— (Day 7-8)

**ä»»åŠ¡æ¸…å•**:
- [ ] ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼
- [ ] æ·»åŠ è¯·æ±‚æ—¥å¿—
- [ ] æ·»åŠ é”™è¯¯æ—¥å¿—
- [ ] é…ç½®æ—¥å¿—çº§åˆ«

### 2.8 éƒ¨ç½²é…ç½® (Day 8-10)

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º Dockerfile
- [ ] åˆ›å»º docker-compose.yml
- [ ] é…ç½®ç¯å¢ƒå˜é‡
- [ ] å¥åº·æ£€æŸ¥ç«¯ç‚¹
- [ ] éƒ¨ç½²æ–‡æ¡£

---

## Phase 3: å‰ç«¯æ’­æ”¾å™¨ (2 å‘¨)

### 3.1 ä¾èµ–å®‰è£… (Day 1)

```bash
npm install @livekit/react-native @livekit/react-native-webrtc
npm install react-native-webrtc
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®‰è£… LiveKit React Native SDK
- [ ] é…ç½® iOS æƒé™ (Info.plist)
- [ ] é…ç½® Android æƒé™ (AndroidManifest.xml)
- [ ] æµ‹è¯• WebRTC åŸºç¡€åŠŸèƒ½

### 3.2 ç›´æ’­æœåŠ¡å°è£… (Day 1-3)

**æ–‡ä»¶**: `frontend/src/features/livestream/services/`

```typescript
// éœ€è¦å®ç°
LiveKitService       // LiveKit è¿æ¥ç®¡ç†
PublisherService     // ä¸»æ’­æ¨æµæœåŠ¡
ViewerService        // è§‚ä¼—è§‚çœ‹æœåŠ¡
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° `LiveKitService` - æˆ¿é—´è¿æ¥/æ–­å¼€
- [ ] å®ç° `PublisherService` - æ¨æµ/åˆ‡æ¢æ‘„åƒå¤´/é™éŸ³
- [ ] å®ç° `ViewerService` - è®¢é˜…è§†é¢‘è½¨é“

### 3.3 ä¸»æ’­æ¨æµé¡µé¢ (Day 3-6)

**æ–‡ä»¶**: `frontend/app/livestream/publish.tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† å¼€å§‹ç›´æ’­                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚      æ‘„åƒå¤´é¢„è§ˆç”»é¢          â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  ç›´æ’­æ ‡é¢˜                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [è¾“å…¥ç›´æ’­æ ‡é¢˜]              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  ç›´æ’­ç±»å‹                           â”‚
â”‚  [æ™®é€š] [ä»˜è´¹] [ç§å¯†]              â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚       [å¼€å§‹ç›´æ’­]             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  [ğŸ”„åˆ‡æ¢] [ğŸ”‡é™éŸ³] [ğŸ“·ç¾é¢œ]        â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»»åŠ¡æ¸…å•**:
- [ ] æ‘„åƒå¤´é¢„è§ˆç»„ä»¶
- [ ] ç›´æ’­ä¿¡æ¯è¡¨å•
- [ ] ç­¾åè·å– Token æµç¨‹
- [ ] å¼€å§‹/ç»“æŸç›´æ’­æŒ‰é’®
- [ ] åˆ‡æ¢æ‘„åƒå¤´åŠŸèƒ½
- [ ] é™éŸ³åŠŸèƒ½
- [ ] ç›´æ’­ä¸­æ§åˆ¶æ 

### 3.4 è§‚ä¼—è§‚çœ‹é¡µé¢ (Day 6-9)

**æ–‡ä»¶**: `frontend/app/livestream/watch/[roomId].tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† ç›´æ’­é—´åç§°           ğŸ‘¤ 1234    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚      è§†é¢‘æ’­æ”¾åŒºåŸŸ            â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  èŠå¤©æ¶ˆæ¯åŒºåŸŸ                â”‚   â”‚
â”‚  â”‚  ç”¨æˆ·A: ä¸»æ’­å¥½æ£’ï¼           â”‚   â”‚
â”‚  â”‚  ç”¨æˆ·B: 666                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [å‘é€æ¶ˆæ¯...]    [ğŸ] [â¤ï¸]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»»åŠ¡æ¸…å•**:
- [ ] è§†é¢‘æ’­æ”¾ç»„ä»¶
- [ ] è·å–è§‚ä¼— Token
- [ ] è®¢é˜…ä¸»æ’­è§†é¢‘è½¨é“
- [ ] æ˜¾ç¤ºè§‚ä¼—æ•°é‡
- [ ] ç›´æ’­çŠ¶æ€å¤„ç† (æœªå¼€æ’­/ç›´æ’­ä¸­/å·²ç»“æŸ)
- [ ] ä»˜è´¹ç›´æ’­é—¨ç¥¨æ£€æŸ¥

### 3.5 ç›´æ’­é—´åˆ—è¡¨é¡µé¢ (Day 9-11)

**æ–‡ä»¶**: `frontend/app/livestream/index.tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç›´æ’­å¤§å…                    [å¼€æ’­] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  [å…¨éƒ¨] [æ¸¸æˆ] [éŸ³ä¹] [èŠå¤©]       â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ å°é¢    â”‚  â”‚ å°é¢    â”‚          â”‚
â”‚  â”‚ ä¸»æ’­A   â”‚  â”‚ ä¸»æ’­B   â”‚          â”‚
â”‚  â”‚ ğŸ‘¤ 1.2k â”‚  â”‚ ğŸ‘¤ 856  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ å°é¢    â”‚  â”‚ å°é¢    â”‚          â”‚
â”‚  â”‚ ä¸»æ’­C   â”‚  â”‚ ä¸»æ’­D   â”‚          â”‚
â”‚  â”‚ ğŸ‘¤ 623  â”‚  â”‚ ğŸ‘¤ 2.1k â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»»åŠ¡æ¸…å•**:
- [ ] ç›´æ’­é—´å¡ç‰‡ç»„ä»¶
- [ ] ç›´æ’­é—´åˆ—è¡¨ (ç½‘æ ¼å¸ƒå±€)
- [ ] åˆ†ç±»ç­›é€‰
- [ ] ä¸‹æ‹‰åˆ·æ–°
- [ ] ç‚¹å‡»è¿›å…¥ç›´æ’­é—´

### 3.6 è§†é¢‘ç»„ä»¶ä¼˜åŒ– (Day 11-14)

**ä»»åŠ¡æ¸…å•**:
- [ ] å…¨å±æ’­æ”¾
- [ ] æ¨ªç«–å±åˆ‡æ¢
- [ ] ç”»è´¨é€‰æ‹© (Simulcast)
- [ ] ç½‘ç»œçŠ¶æ€æ˜¾ç¤º
- [ ] åŠ è½½çŠ¶æ€ UI
- [ ] é”™è¯¯å¤„ç† UI

---

## Phase 4: äº’åŠ¨åŠŸèƒ½ (1.5 å‘¨)

### 4.1 èŠå¤©æœåŠ¡ (Day 1-2)

**æ–‡ä»¶**: `frontend/src/features/livestream/services/ChatService.ts`

```typescript
// éœ€è¦å®ç°
- å‘é€èŠå¤©æ¶ˆæ¯
- å‘é€å¼¹å¹•
- å‘é€ç¤¼ç‰©é€šçŸ¥
- å‘é€ç‚¹èµ
- æ¶ˆæ¯é™æµ
```

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° `LiveChatService` ç±»
- [ ] DataChannel æ¶ˆæ¯ç¼–è§£ç 
- [ ] æ¶ˆæ¯ç±»å‹å®šä¹‰
- [ ] é™æµå™¨ (5æ¡/ç§’)

### 4.2 èŠå¤©ç»„ä»¶ (Day 2-4)

**æ–‡ä»¶**: `frontend/src/features/livestream/components/LiveChat.tsx`

**ä»»åŠ¡æ¸…å•**:
- [ ] æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶
- [ ] æ¶ˆæ¯è¾“å…¥æ¡†
- [ ] å‘é€æŒ‰é’®
- [ ] ç¤¼ç‰©æ¶ˆæ¯æ ·å¼
- [ ] ç³»ç»Ÿæ¶ˆæ¯æ ·å¼
- [ ] è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨

### 4.3 å¼¹å¹•ç»„ä»¶ (Day 4-5)

**æ–‡ä»¶**: `frontend/src/features/livestream/components/DanmakuOverlay.tsx`

**ä»»åŠ¡æ¸…å•**:
- [ ] å¼¹å¹•åŠ¨ç”» (ä»å³åˆ°å·¦æ»šåŠ¨)
- [ ] å¤šè½¨é“æ˜¾ç¤º
- [ ] å¼¹å¹•é¢œè‰²
- [ ] å¼¹å¹•å‘é€å…¥å£
- [ ] æ€§èƒ½ä¼˜åŒ– (é™åˆ¶åŒå±æ•°é‡)

### 4.4 ç¤¼ç‰©ç³»ç»Ÿ (Day 5-8)

**æ–‡ä»¶**: `frontend/src/features/livestream/components/GiftPanel.tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€ç¤¼ç‰©                      [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  [ğŸŒ¹ç«ç‘°]  [ğŸ’é’»çŸ³]  [ğŸš€ç«ç®­]      â”‚
â”‚   1 DUST   10 DUST   100 DUST      â”‚
â”‚                                     â”‚
â”‚  [ğŸï¸è·‘è½¦]  [ğŸ åŸå ¡]  [ğŸŒæ˜Ÿçƒ]      â”‚
â”‚  500 DUST  1000 DUST 5000 DUST     â”‚
â”‚                                     â”‚
â”‚  æ•°é‡: [1] [10] [99] [520]         â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚       [å‘é€ 10 DUST]        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»»åŠ¡æ¸…å•**:
- [ ] ç¤¼ç‰©é¢æ¿ç»„ä»¶
- [ ] ç¤¼ç‰©åˆ—è¡¨ (ä»é“¾ä¸ŠæŸ¥è¯¢)
- [ ] æ•°é‡é€‰æ‹©
- [ ] å‘é€ç¤¼ç‰© (é“¾ä¸Šäº¤æ˜“)
- [ ] ç¤¼ç‰©åŠ¨ç”»æ•ˆæœ
- [ ] ç¤¼ç‰©é€šçŸ¥å¹¿æ’­ (DataChannel)

### 4.5 ç‚¹èµåŠŸèƒ½ (Day 8-9)

**ä»»åŠ¡æ¸…å•**:
- [ ] ç‚¹èµæŒ‰é’®
- [ ] ç‚¹èµåŠ¨ç”» (é£˜å¿ƒ)
- [ ] ç‚¹èµè®¡æ•°
- [ ] ç‚¹èµé™æµ

### 4.6 äº’åŠ¨çŠ¶æ€ç®¡ç† (Day 9-10)

**æ–‡ä»¶**: `frontend/src/stores/livestreamStore.ts`

```typescript
interface LivestreamState {
  // å½“å‰ç›´æ’­é—´
  currentRoom: LiveRoom | null;
  // è¿æ¥çŠ¶æ€
  connectionState: 'disconnected' | 'connecting' | 'connected';
  // è§‚ä¼—æ•°
  viewerCount: number;
  // èŠå¤©æ¶ˆæ¯
  messages: ChatMessage[];
  // ç¤¼ç‰©åˆ—è¡¨
  gifts: Gift[];
}
```

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º Zustand store
- [ ] ç›´æ’­é—´çŠ¶æ€ç®¡ç†
- [ ] æ¶ˆæ¯çŠ¶æ€ç®¡ç†
- [ ] ç¤¼ç‰©çŠ¶æ€ç®¡ç†

---

## Phase 5: é«˜çº§åŠŸèƒ½ (2 å‘¨)

### 5.1 è¿éº¦åŠŸèƒ½ - è§‚ä¼—ç«¯ (Day 1-3)

**æ–‡ä»¶**: `frontend/src/features/livestream/services/CoHostApplicant.ts`

**ä»»åŠ¡æ¸…å•**:
- [ ] ç”³è¯·è¿éº¦ (DataChannel)
- [ ] ç›‘å¬ä¸»æ’­å“åº”
- [ ] å¼€å¯æ‘„åƒå¤´/éº¦å…‹é£
- [ ] ç»“æŸè¿éº¦
- [ ] è¿éº¦çŠ¶æ€ UI

### 5.2 è¿éº¦åŠŸèƒ½ - ä¸»æ’­ç«¯ (Day 3-5)

**æ–‡ä»¶**: `frontend/src/features/livestream/services/CoHostManager.ts`

**ä»»åŠ¡æ¸…å•**:
- [ ] æ¥æ”¶è¿éº¦ç”³è¯·
- [ ] ç”³è¯·åˆ—è¡¨ UI
- [ ] åŒæ„/æ‹’ç»è¿éº¦
- [ ] ç®¡ç†è¿éº¦è€… (é™éŸ³/è¸¢å‡º)
- [ ] è®°å½•è¿éº¦åˆ°é“¾ä¸Š

### 5.3 è¿éº¦å¸ƒå±€ (Day 5-7)

**æ–‡ä»¶**: `frontend/src/features/livestream/components/CoHostLayout.tsx`

**ä»»åŠ¡æ¸…å•**:
- [ ] ç”»ä¸­ç”»å¸ƒå±€
- [ ] åˆ†å±å¸ƒå±€
- [ ] ç½‘æ ¼å¸ƒå±€
- [ ] å¸ƒå±€åˆ‡æ¢
- [ ] è¿éº¦è€…ä¿¡æ¯æ˜¾ç¤º

### 5.4 ä»˜è´¹ç›´æ’­ (Day 7-10)

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºä»˜è´¹ç›´æ’­é—´ (è®¾ç½®ç¥¨ä»·)
- [ ] è´­ç¥¨é¡µé¢
- [ ] è´­ç¥¨äº¤æ˜“ (é“¾ä¸Š)
- [ ] é—¨ç¥¨éªŒè¯
- [ ] å·²è´­ç¥¨ç”¨æˆ·åˆ—è¡¨

### 5.5 ç›´æ’­å›æ”¾ (Day 10-12)

**ä»»åŠ¡æ¸…å•**:
- [ ] LiveKit å½•åˆ¶é…ç½®
- [ ] å›æ”¾ä¸Šä¼ åˆ° IPFS
- [ ] å›æ”¾åˆ—è¡¨é¡µé¢
- [ ] å›æ”¾æ’­æ”¾å™¨

### 5.6 ä¸»æ’­ç®¡ç†åŠŸèƒ½ (Day 12-14)

**ä»»åŠ¡æ¸…å•**:
- [ ] è¸¢å‡ºè§‚ä¼—
- [ ] é»‘åå•ç®¡ç†
- [ ] ç¦è¨€åŠŸèƒ½ (LiveKit)
- [ ] ç›´æ’­é—´è®¾ç½®

---

## Phase 6: æµ‹è¯•ä¼˜åŒ– (1 å‘¨)

### 6.1 é›†æˆæµ‹è¯• (Day 1-3)

**ä»»åŠ¡æ¸…å•**:
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•: åˆ›å»ºç›´æ’­é—´ â†’ å¼€æ’­ â†’ è§‚çœ‹ â†’ ç»“æŸ
- [ ] ç¤¼ç‰©æ‰“èµæµç¨‹æµ‹è¯•
- [ ] è¿éº¦æµç¨‹æµ‹è¯•
- [ ] ä»˜è´¹ç›´æ’­æµç¨‹æµ‹è¯•
- [ ] å¼‚å¸¸åœºæ™¯æµ‹è¯•

### 6.2 æ€§èƒ½ä¼˜åŒ– (Day 3-5)

**ä»»åŠ¡æ¸…å•**:
- [ ] è§†é¢‘æ¸²æŸ“ä¼˜åŒ–
- [ ] å¼¹å¹•æ€§èƒ½ä¼˜åŒ–
- [ ] å†…å­˜æ³„æ¼æ£€æŸ¥
- [ ] ç½‘ç»œé‡è¿ä¼˜åŒ–
- [ ] å¼±ç½‘é€‚é…

### 6.3 å…¼å®¹æ€§æµ‹è¯• (Day 5-6)

**ä»»åŠ¡æ¸…å•**:
- [ ] iOS è®¾å¤‡æµ‹è¯•
- [ ] Android è®¾å¤‡æµ‹è¯•
- [ ] ä¸åŒç½‘ç»œç¯å¢ƒæµ‹è¯•
- [ ] WebRTC å…¼å®¹æ€§æ£€æŸ¥
- [ ] HLS é™çº§æ–¹æ¡ˆ

### 6.4 æ–‡æ¡£å®Œå–„ (Day 6-7)

**ä»»åŠ¡æ¸…å•**:
- [ ] API æ–‡æ¡£
- [ ] å‰ç«¯ç»„ä»¶æ–‡æ¡£
- [ ] éƒ¨ç½²æ–‡æ¡£
- [ ] ç”¨æˆ·ä½¿ç”¨æŒ‡å—

---

## æŠ€æœ¯æ ˆæ€»ç»“

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| é“¾ä¸Š | Substrate / pallet-livestream |
| åç«¯ | Node.js / Express / livekit-server-sdk |
| åª’ä½“ | LiveKit (WebRTC SFU) |
| å‰ç«¯ | React Native / Expo / @livekit/react-native |
| çŠ¶æ€ | Zustand |
| å­˜å‚¨ | IPFS (å°é¢/å›æ”¾) |

---

## é£é™©ä¸ç¼“è§£

| é£é™© | ç¼“è§£æªæ–½ |
|------|----------|
| LiveKit ä¸­å›½å»¶è¿Ÿ | æ—©æœŸæ¥å—ï¼ŒåæœŸè‡ªå»ºå›½å†…æœåŠ¡å™¨ |
| WebRTC å…¼å®¹æ€§ | å‡†å¤‡ HLS é™çº§æ–¹æ¡ˆ |
| åç«¯å•ç‚¹æ•…éšœ | éƒ¨ç½²å¤šå®ä¾‹ + è´Ÿè½½å‡è¡¡ |
| é“¾ä¸Šäº¤æ˜“å»¶è¿Ÿ | ä¹è§‚ UI æ›´æ–°ï¼Œåå°ç¡®è®¤ |

---

## é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | æ—¶é—´ | äº¤ä»˜ç‰© |
|--------|------|--------|
| M1 | Week 2 | pallet-livestream å®Œæˆï¼Œé€šè¿‡å•å…ƒæµ‹è¯• |
| M2 | Week 3.5 | åç«¯æœåŠ¡å®Œæˆï¼ŒToken ç”Ÿæˆå¯ç”¨ |
| M3 | Week 5.5 | åŸºç¡€ç›´æ’­åŠŸèƒ½å¯ç”¨ (æ¨æµ/è§‚çœ‹) |
| M4 | Week 7 | äº’åŠ¨åŠŸèƒ½å®Œæˆ (èŠå¤©/å¼¹å¹•/ç¤¼ç‰©) |
| M5 | Week 9 | é«˜çº§åŠŸèƒ½å®Œæˆ (è¿éº¦/ä»˜è´¹) |
| M6 | Week 10 | æµ‹è¯•é€šè¿‡ï¼Œå¯ä¸Šçº¿ |
